

## 🛡️ 헤더와 해킹 보안

네트워크 통신에서 데이터 헤더는 라우팅 및 제어 정보를 담고 있지만, 공격자들은 이 헤더 필드를 조작하거나 특정 정보를 추출하여 공격을 수행합니다. 따라서 방어 시스템은 특정 헤더 필드를 면밀히 분석하여 악의적인 행위를 탐지합니다.

### 1. 해킹 프로그램에 악용되는 주요 헤더 및 사용 내용

| 프로토콜 | 헤더 필드 | 악용 목적 및 방법 |
| :---: | :---: | :--- |
| **IP** | **Source Address** | **IP 스푸핑(Spoofing):** 발신지 주소를 위조하여 공격자의 실제 신원을 숨기거나, 응답 패킷을 다른 희생자에게 보내는 **DDoS 공격(예: Smurf)**에 사용됩니다. |
| **IP** | **Fragment Offset / Flags** | **단편화 공격(Fragmentation Attack):** 패킷을 매우 작게 단편화하여 보안 장비의 탐지 로직을 우회하거나, 비정상적인 오프셋으로 시스템을 마비시킵니다. |
| **TCP** | **Flags (SYN, ACK, FIN, RST)** | **포트 스캔 (Port Scanning):** SYN, FIN, Null, Xmas 스캔 등 다양한 플래그 조합을 사용하여 대상 시스템의 포트 상태를 은밀하게 확인합니다. |
| **TCP** | **Source Port / Destination Port** | **터널링(Tunneling) 및 우회:** 비표준 포트(예: HTTP 80 포트)를 사용하여 C&C(Command and Control) 트래픽을 숨기거나 방화벽을 우회합니다. |
| **HTTP** | **User-Agent** | **정보 수집:** 대상 시스템이 실행하는 운영체제, 브라우저 등의 정보를 수집하여 취약점 공격에 활용합니다. |
| **HTTP** | **Referer** | **세션 탈취/CSRF:** 특정 웹사이트를 경유한 것처럼 위장하거나, CSRF(Cross-Site Request Forgery) 공격의 유효성 검증을 우회합니다. |

---

### 2. 보안 프로그램이 방어를 위해 주시하는 헤더

침입 탐지 시스템(IDS)이나 방화벽(Firewall)과 같은 보안 프로그램은 다음 헤더들을 분석하여 비정상적인 트래픽을 식별합니다.

| 프로토콜 | 헤더 필드 | 주시하는 이유 및 방어 활동 |
| :---: | :---: | :--- |
| **IP** | **Time to Live (TTL)** | **비정상적 경로 탐지:** TTL 값이 비정상적으로 작거나 특정 패턴을 보이면, 공격자가 프록시를 사용하거나 네트워크 경로를 조작했는지 확인합니다. |
| **IP** | **Header Checksum** | **패킷 변조 탐지:** 체크섬 불일치는 전송 중 오류를 의미하지만, 의도적인 체크섬 조작을 통해 보안 장비의 처리 부하를 유발하거나 오탐을 유도하는지 감시합니다. |
| **TCP** | **Flags (SYN, ACK, FIN, RST)** | **DDoS 및 스캔 탐지:** 비정상적으로 높은 **SYN** 플래그 비율 (**SYN Flooding**)이나, **SYN** 없이 **ACK**가 오는 경우 (**ACK Scanning**) 등을 탐지하여 방어합니다. |
| **TCP** | **Window Size** | **비정상적 흐름 제어:** 윈도우 크기가 0이거나 특정 크기를 반복적으로 설정하여 DoS 공격을 시도하는지 감시합니다. |
| **HTTP** | **Content-Length** | **버퍼 오버플로우:** 본문의 실제 길이($Content-Length$)와 수신된 데이터의 길이가 일치하지 않거나, 비정상적으로 큰 값일 경우 버퍼 오버플로우 공격을 시도하는지 주시합니다. |
| **HTTP** | **Host** | **가상 호스트 악용:** HTTP 요청의 $Host$ 헤더를 분석하여 정상적인 서비스 도메인으로의 요청인지, 아니면 다른 도메인을 대상으로 하는 공격인지(예: 비정상적인 서버 접근) 확인합니다. |
| **HTTP** | **Cookie / Authorization** | **인증 및 세션 탈취:** $Cookie$나 $Authorization$ 헤더의 비정상적인 사용 패턴(예: 대량 요청, 변조)을 감시하여 세션 탈취를 방지합니다. |

---

## 📝 주요 헤더 필드 설명

### 1. IP 헤더 (네트워크 계층)

* **Source Address (발신지 주소):** 가장 기본적인 보안 위협인 **스푸핑(Spoofing)**에 악용됩니다. 보안 시스템은 송신 주소의 유효성(Inbound Filtering)을 검증하여 내부망에서 외부 주소를 사용하는 패킷을 차단합니다.
* **TTL (Time to Live):** 패킷이 네트워크를 무한히 순환하는 것을 방지하는 카운터입니다. **보안 관점**에서는 TTL 값을 통해 공격자가 사용하는 **운영체제(OS)**를 추측하거나(각 OS마다 기본 TTL 값이 다름), **프록시 서버**나 **VPN** 사용 여부를 추정하는 데 활용됩니다.

### 2. TCP 헤더 (전송 계층)

* **Flags:** TCP 연결의 상태를 나타내는 가장 중요한 필드입니다.
    * **SYN/ACK:** 연결 설정 과정의 핵심 플래그로, 이 플래그들의 **비율**이나 **시퀀스**를 분석하여 **SYN Flooding DDoS** 공격이나 **은밀한 스캔(Stealth Scan)**을 탐지합니다.
    * **RST:** 비정상 종료를 나타냅니다. 정상적인 통신 과정 없이 갑자기 $RST$ 플래그가 대량 발생하면 비정상적인 연결 시도나 강제 종료 공격으로 간주합니다.

### 3. HTTP 헤더 (애플리케이션 계층)

* **User-Agent:** 클라이언트 정보(브라우저, OS)를 포함합니다. 공격자는 이를 조작하여 취약한 버전을 사칭하거나, 봇(Bot) 트래픽을 숨기는 데 사용합니다. 보안 솔루션은 비정상적이거나 알려진 악성 $User-Agent$ 패턴을 탐지합니다.
* **Content-Length:** POST 요청 본문의 길이를 나타냅니다. 이 값을 조작하여 **HTTP Desync** 공격이나 **버퍼 오버플로우**를 유도할 수 있으므로, 방화벽이나 웹 방화벽(WAF)은 이 값을 실제 패킷 길이와 비교하며 일치 여부를 검사합니다.

> **강조:** 현대의 보안 방어는 단순히 헤더 필드의 값만 보는 것이 아니라, **헤더 필드 값의 비정상적인 패턴**과 **패킷의 순서, 빈도, 그리고 페이로드 내용**을 종합적으로 분석하여 공격을 탐지합니다.

이러한 헤더들을 모니터링하는 **IDS/IPS(침입 탐지/방지 시스템)**에 대해 더 깊이 알아볼까요?
