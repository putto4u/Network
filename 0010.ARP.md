## 🔍 ARP (Address Resolution Protocol)

**ARP**는 네트워크 계층 주소인 **IP 주소**를 데이터 링크 계층 주소인 **MAC 주소**로 변환하는 데 사용되는 프로토콜입니다.

네트워크 통신은 2계층(데이터 링크)의 MAC 주소와 3계층(네트워크)의 IP 주소가 모두 필요합니다. IP 주소는 통신 대상을 식별하고 라우팅하는 데 사용되지만, 실제 데이터를 물리적으로 전달하기 위해서는 동일 네트워크 내에서 장치를 식별하는 MAC 주소가 필수적입니다.

---

### 1. ARP의 작동 원리

ARP는 기본적으로 동일한 로컬 네트워크(세그먼트) 내에서 작동합니다.

1.  **ARP Request (질문):**
    * 통신을 원하는 호스트 A는 목적지 호스트 B의 **IP 주소는 알고 있지만, MAC 주소를 모를 때** ARP Request를 보냅니다.
    * 이 요청은 네트워크 전체(브로드캐스트)로 전송되며, 내용은 "IP 주소가 **192.168.1.10**인 장치야, 너의 MAC 주소는 무엇이니?"와 같습니다.
    * 패킷의 목적지 MAC 주소는 **FF:FF:FF:FF:FF:FF** (브로드캐스트 주소)로 설정됩니다.

2.  **ARP Reply (응답):**
    * 네트워크의 모든 장치는 이 요청을 받지만, 자신의 IP 주소와 요청된 IP 주소가 일치하는 **호스트 B**만 응답합니다.
    * 호스트 B는 자신의 **MAC 주소**가 포함된 **ARP Reply**를 호스트 A에게 유니캐스트(1:1 전송)로 보냅니다.
    * 응답 내용은 "내가 192.168.1.10이야, 내 MAC 주소는 **00:1A:2B:3C:4D:5E**야"와 같습니다.

3.  **ARP 캐싱:**
    * 호스트 A는 이 응답을 받으면, 호스트 B의 IP 주소와 MAC 주소 쌍을 자신의 **ARP 캐시 테이블**에 일정 시간 동안 저장합니다.
    * 다음 통신부터는 이 캐시 테이블을 먼저 확인하여, 불필요한 ARP Request를 줄이고 성능을 향상시킵니다.



---

### 2. 역ARP (RARP)와 프록시 ARP

| 용어 | 풀이 및 역할 |
| :--- | :--- |
| **RARP (Reverse ARP)** | **자신의 MAC 주소**를 이용해 **자신의 IP 주소**를 알아내기 위한 프로토콜이었습니다. 디스크가 없는 워크스테이션에서 주로 사용되었으나, 현재는 **DHCP**로 대체되어 거의 사용되지 않습니다. |
| **Proxy ARP** | 라우터가 다른 네트워크에 있는 호스트에 대한 ARP 요청에 **자신의 MAC 주소**로 대신 응답하는 기술입니다. 이는 실제 목적지가 다른 네트워크에 있지만, 요청한 호스트에게는 마치 같은 네트워크에 있는 것처럼 보이게 하여 통신을 가능하게 합니다. |

---

### 💡 실전 팁: ARP Spoofing과 보안

ARP는 인증 과정 없이 응답을 신뢰하기 때문에 보안에 취약합니다.

* **ARP 스푸핑(Spoofing):** 공격자가 ARP Reply를 위조하여, 특정 IP 주소(예: 게이트웨이)에 대한 MAC 주소 정보를 자신의 MAC 주소로 속여 전송하는 공격입니다.
* **결과:** 네트워크 트래픽이 공격자에게 우회되거나(MITM, Man-In-The-Middle), 통신이 마비될 수 있습니다. 네트워크 보안에서 ARP 관련 방어는 필수적입니다.


---
## 💾 ARP 명령어 사용 방법

ARP 캐시 테이블을 확인하고 관리하는 명령어는 주로 \*\*`arp`\*\*를 사용하며, 명령창(Bash 또는 터미널) 프롬프트와 함께 표기하면 다음과 같습니다.

-----

### 1\. ARP 캐시 테이블 확인하기

현재 시스템에 저장된 모든 ARP 캐시 항목을 출력합니다. 트러블슈팅이나 스푸핑 징후를 확인할 때 가장 기본이 되는 명령입니다.

```bash
$ arp -a
```

### 2\. 특정 호스트의 ARP 항목 확인하기

특정 IP 주소에 대한 ARP 항목만 확인하고 싶을 때 사용합니다.

```bash
$ arp -n [IP 주소]
# 예시: $ arp -n 192.168.1.1
```

> **참고:** `-n` 옵션은 이름 해석(DNS 룩업)을 하지 않고 IP 주소 그대로 출력하여 속도를 높입니다.

---
## 💻 `arp -a` 명령어의 기능과 활용

`arp -a` 명령어는 현재 컴퓨터의 **ARP 캐시 테이블**에 저장된 모든 항목을 확인하는 데 사용됩니다.

ARP(Address Resolution Protocol) 캐시는 이전에 통신했던 장치들의 **IP 주소**와 **MAC 주소** 쌍을 임시로 저장하는 메모리 영역입니다. 이 명령어를 사용하면 네트워크 트러블슈팅과 보안 분석에 필요한 중요한 정보를 얻을 수 있습니다.

-----

### 1\. `arp -a` 명령어의 역할

  * **ARP 캐시 테이블 조회:** 현재 시스템이 가지고 있는 **모든 ARP 항목**을 출력합니다.
  * **IP-MAC 주소 매핑 확인:** 통신했던 로컬 네트워크 장치들의 **IP 주소**와 **물리적 MAC 주소**가 올바르게 연결되어 있는지 확인할 수 있습니다.
  * **인터페이스별 목록:** 여러 개의 네트워크 인터페이스(예: 유선 LAN, Wi-Fi)를 사용하는 경우, 각 인터페이스별로 별도의 ARP 테이블 목록을 보여줍니다.

### 2\. 출력 결과 예시 및 분석

Windows 운영체제에서 `arp -a`를 실행했을 때의 출력 예시는 다음과 같습니다.

```
Interface: 192.168.1.5 --- 0x3
  Internet Address      Physical Address      Type
  192.168.1.1           a0-b1-c2-d3-e4-f5     dynamic
  192.168.1.10          00-11-22-33-44-55     static
  192.168.1.254         ff-ff-ff-ff-ff-ff     static
```

| 필드 | 의미 | 설명 |
| :--- | :--- | :--- |
| **Interface** | 현재 ARP 항목이 속한 로컬 **인터페이스의 IP 주소**와 인덱스 번호 | `192.168.1.5`는 명령어를 실행한 컴퓨터의 IP 주소입니다. |
| **Internet Address** | ARP 캐시에 등록된 **목적지 장치의 IP 주소** | 통신했던 다른 컴퓨터, 라우터(게이트웨이) 등의 IP 주소입니다. |
| **Physical Address** | 해당 IP 주소에 대응하는 **MAC 주소** | 실제 데이터를 전송하는 데 사용되는 물리적 주소입니다. |
| **Type** | ARP 항목의 **유형** | \* **dynamic (동적):** ARP 요청-응답을 통해 자동으로 학습된 항목 (일정 시간이 지나면 삭제). |
| | | \* **static (정적):** 사용자가 **수동으로** `arp -s` 명령어를 사용하여 추가한 항목 (재부팅해도 유지). |

-----

### 3\. 실전 활용 팁

#### A. 네트워크 트러블슈팅

  * **게이트웨이 MAC 확인:** 인터넷 접속에 문제가 있을 때, 게이트웨이 IP 주소(`192.168.1.1` 등)의 MAC 주소가 올바른지 확인하여 로컬 네트워크 연결 문제를 진단할 수 있습니다.
  * **잘못된 매핑 감지:** 특정 IP에 대해 **예상치 못한 MAC 주소**가 표시된다면 통신 오류나 설정 문제를 의심해 볼 수 있습니다.

#### B. 보안 분석 (ARP 스푸핑 탐지)

  * `arp -a` 명령은 **ARP 스푸핑(Spoofing)** 공격의 징후를 찾는 데 유용합니다.
  * 만약 네트워크 상의 **다른 장치들의 IP 주소**가 모두 **하나의 동일한 MAC 주소**로 매핑되어 있다면, 이는 공격자가 자신의 MAC 주소로 속여 트래픽을 가로채고 있는 ARP 스푸핑 공격일 가능성이 높습니다.
  * **대응:** ARP 캐시 항목을 수동으로 삭제(`arp -d`)하거나, 올바른 정적 항목으로 재설정(`arp -s`)하여 문제를 일시적으로 해결할 수 있습니다.


---
### 3\. 정적(Static) ARP 항목 추가하기

특정 IP 주소와 MAC 주소 쌍을 **수동으로** ARP 캐시에 영구적으로 등록합니다. 이는 ARP 스푸핑 공격을 방지하는 기본적인 방어책 중 하나로, 게이트웨이와 같은 중요한 장치에 사용될 수 있습니다.

```bash
$ arp -s [IP 주소] [MAC 주소]
# 예시: $ arp -s 192.168.1.1 a0-b1-c2-d3-e4-f5
```

> **참고:** MAC 주소 표기 형식은 시스템에 따라 콜론(`:`)이나 하이픈(`-`)을 사용할 수 있습니다.

### 4\. ARP 캐시 항목 삭제하기

ARP 캐시의 특정 항목을 삭제합니다. 스푸핑 공격을 받은 후 캐시를 초기화하거나, 잘못된 매핑을 수정할 때 유용합니다.

```bash
$ arp -d [IP 주소]
# 예시: $ arp -d 192.168.1.1
```

### 5\. 모든 동적(Dynamic) ARP 항목 삭제하기

현재 시스템에 저장된 모든 **동적** ARP 캐시 항목을 지웁니다.

```bash
$ arp -d
```

> **주의:** 이 명령은 실행하는 시스템에 따라 모든 ARP 캐시를 삭제하거나, 옵션 없이 실행 시 사용법을 출력하는 등 다르게 작동할 수 있습니다. Windows에서는 `arp -d *`를 사용해야 전체 삭제가 가능할 수도 있습니다.
